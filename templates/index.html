[[extend 'layout.html']]

<!DOCTYPE html>
<html>
<head>
    <title>Drawable Grid</title>
    <style>
        #myCanvas {
            border: 1px solid #000;
        }
        .color {
            width: 50px;
            height: 50px;
            display: inline-block;
            margin: 2px;
        }
    </style>
</head>
<body>
    <canvas id="myCanvas" width="500" height="500"></canvas>

    <div>
        <div class="color" style="background-color: red;" id="red"></div>
        <div class="color" style="background-color: green;" id="green"></div>
        <div class="color" style="background-color: blue;" id="blue"></div>
        <div class="color" style="background-color: yellow;" id="yellow"></div>
        <div class="color" style="background-color: black;" id="black"></div>
    </div>

    <script>
        var canvas = document.getElementById('myCanvas');
        var ctx = canvas.getContext('2d');
        var isDrawing = false;
        var gridSize = 20;
        var selectedColor = 'black';

        // Draw initial grid
        drawGrid();

        // Event listener for mousedown
        canvas.addEventListener('mousedown', function(e) {
            isDrawing = true;
            draw(e);
        });

        // Event listener for mouseup
        canvas.addEventListener('mouseup', function() {
            isDrawing = false;
            ctx.beginPath();
        });

        // Event listener for mousemove
        canvas.addEventListener('mousemove', draw);

        // Event listener for color selection
        document.querySelectorAll('.color').forEach(item => {
            item.addEventListener('click', event => {
                selectedColor = event.target.id;
            });
        });

        // Drawing function
        function draw(e) {
            if (!isDrawing) return;
            let rect = canvas.getBoundingClientRect();
            let x = Math.floor((e.clientX - rect.left) / gridSize);
            let y = Math.floor((e.clientY - rect.top) / gridSize);
            ctx.fillStyle = selectedColor;
            ctx.fillRect(x * gridSize, y * gridSize, gridSize, gridSize);
        }

        // Function to draw grid
        function drawGrid() {
            for(let i = 0; i < canvas.width / gridSize; i++) {
                for(let j = 0; j < canvas.height / gridSize; j++) {
                    ctx.strokeStyle = 'rgba(0,0,0,0.1)';
                    ctx.strokeRect(i * gridSize, j * gridSize, gridSize, gridSize);
                }
            }
        }
    </script>
</body>
</html>


<div class="section">
  <div class="vars">
      [[=message]]
  </div>
</div>